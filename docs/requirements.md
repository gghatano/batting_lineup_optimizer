# 要件定義書

## 0. 概要

Google Spreadsheet から取得した打撃成績を基に、ブラウザ上で 9 人の打順をヒューリスティック最適化し、シミュレーションによる平均得点を可視化する Web アプリを提供する。

## 0.1 実装状況

**Phase 1 完了** (2025-07-24)
- ✅ プロジェクト基盤構築 (Vite + React 18 + TypeScript 5)
- ✅ 開発環境整備 (ESLint, Prettier, 依存関係設定)
- ✅ 基本ディレクトリ構造作成
- ✅ 動作確認完了 (http://localhost:5173/)

## 1. 利用者像

| ID | ペルソナ                  | ニーズ                                         |
| -- | --------------------- | ------------------------------------------- |
| U1 | 野球好きのエンジニア／学生（PC・スマホ） | 12 球団から選手を選び、自分で指定した回数の試合シミュレーションで最強打順を探したい |

## 2. ユーザーストーリー

### US-01 選手と試行回数を設定できる

* **受入基準**

  1. WHEN 利用者が 12 球団のいずれかをプルダウンで選択する
  2. THEN 当該球団の選手一覧と主要打撃成績がテーブル表示される
  3. WHEN 利用者が 9 名をクリックで選択し打順をドラッグ＆ドロップで並べる
  4. THEN シミュレーション回数を GUI（数値入力 / スライダー）で設定できる
  5. SHALL 入力値が整数かつ上限（デフォルト 10 万回）を超えない場合のみ開始ボタンを有効化する

### US-02 試合シミュレーション結果を確認できる

* **受入基準**

  1. WHEN 「シミュレーション開始」を押す
  2. THEN 指定回数分の試合を Web Worker で実行し、平均・中央値・90%tile 得点を表示する
  3. SHALL 95 パーセンタイル応答時間が 200 ms 未満（10 試合あたり）である

### US-03 ヒューリスティックに最適打順を探索できる

* **受入基準**

  1. WHEN 利用者が「最適化」を開始し、入れ替え方法（近隣／遠隔）のいずれかを選択する
  2. THEN エンジンが 1 箇所のみの入れ替えを繰り返し、改善がなくなるまで探索する
  3. THEN 各入れ替え後の打順と平均得点を履歴テーブルに追記する
  4. SHALL 完了後に最高得点打順と平均得点をハイライト表示し、元の打順との差分を示す

## 3. 非機能要件

| 区分     | 指標                                | 目標値      |
| ------ | --------------------------------- | -------- |
| 性能     | 95th p.レスポンス時間（10 試合）             | < 200 ms |
| 性能     | 95th p.レスポンス時間（最適化 1000 試合×50 反復） | < 10 s   |
| 可用性    | GitHub Pages 稼働率                  | ≥ 99.9 % |
| セキュリティ | 認証不要・読み取り専用サイト                    | MUST     |
| 保守性    | TypeScript ビルド／ ESLint エラー        | 0        |
| 運用     | GitHub Actions 成功率                | ≥ 95 %   |

---

### データ仕様メモ（参照用）

* **取得先**：ユーザが提示する Google Spreadsheet を Web 公開した CSV URL

* **テーブル雛形（例）**

  | team | name | PA | 1B | 2B | 3B | HR | SO | BB | OUT\_OTHER |
  | ---- | ---- | -- | -- | -- | -- | -- | -- | -- | ---------- |


### 技術スタック備考

* **フロント**：React + Vite + TypeScript、状態管理 TanStack Query
* **ホスティング**：GitHub Pages

